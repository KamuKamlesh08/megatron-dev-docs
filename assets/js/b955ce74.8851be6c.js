"use strict";(self.webpackChunkmegatron_dev_docs=self.webpackChunkmegatron_dev_docs||[]).push([[195],{8453:(e,a,n)=>{n.d(a,{R:()=>i,x:()=>o});var s=n(6540);const t={},r=s.createContext(t);function i(e){const a=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(r.Provider,{value:a},e.children)}},8743:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"projects/megatron-kafka-lab/kafka-advanced-console-lab","title":"Kafka Advanced Console Lab","description":"This lab extends the basics and shows advanced console-only Kafka testing flows.","source":"@site/docs/projects/megatron-kafka-lab/08-kafka-advanced-console-lab.md","sourceDirName":"projects/megatron-kafka-lab","slug":"/projects/megatron-kafka-lab/kafka-advanced-console-lab","permalink":"/docs/projects/megatron-kafka-lab/kafka-advanced-console-lab","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{},"sidebar":"docs","previous":{"title":"Kafka Console Testing Guide (Docker Setup)","permalink":"/docs/projects/megatron-kafka-lab/kafka-console-guide"},"next":{"title":"User Initial Load & Personalized Homepage","permalink":"/docs/architecture/e-commerce/01-home-page"}}');var t=n(4848),r=n(8453);const i={},o="Kafka Advanced Console Lab",c={},d=[{value:"Step 1: Topic describe and configs",id:"step-1-topic-describe-and-configs",level:2},{value:"Create or verify topic",id:"create-or-verify-topic",level:3},{value:"Describe topic",id:"describe-topic",level:3},{value:"Change retention and verify",id:"change-retention-and-verify",level:3},{value:"Step 2: Increase partitions and observe",id:"step-2-increase-partitions-and-observe",level:2},{value:"Step 3: Consumer lag monitoring",id:"step-3-consumer-lag-monitoring",level:2},{value:"Step 4: Offset reset demos",id:"step-4-offset-reset-demos",level:2},{value:"Earliest",id:"earliest",level:3},{value:"Latest",id:"latest",level:3},{value:"By duration (last 24 hours)",id:"by-duration-last-24-hours",level:3},{value:"Specific offset",id:"specific-offset",level:3},{value:"Step 5: Per-key ordering guarantee",id:"step-5-per-key-ordering-guarantee",level:2},{value:"Step 6: Sticky partitioning without key",id:"step-6-sticky-partitioning-without-key",level:2},{value:"Step 7: Headers via REST Proxy (if available)",id:"step-7-headers-via-rest-proxy-if-available",level:2},{value:"Step 8: Multiple topics fan-out",id:"step-8-multiple-topics-fan-out",level:2},{value:"Step 9: Auto-create off validation",id:"step-9-auto-create-off-validation",level:2},{value:"Step 10: Cleanup patterns",id:"step-10-cleanup-patterns",level:2},{value:"Step 11: Delete topic and verify",id:"step-11-delete-topic-and-verify",level:2},{value:"Step 12: Producer acknowledgements (concept)",id:"step-12-producer-acknowledgements-concept",level:2},{value:"Step 13: Rebalance demo",id:"step-13-rebalance-demo",level:2},{value:"Recap",id:"recap",level:2}];function l(e){const a={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.header,{children:(0,t.jsx)(a.h1,{id:"kafka-advanced-console-lab",children:"Kafka Advanced Console Lab"})}),"\n",(0,t.jsx)(a.p,{children:"This lab extends the basics and shows advanced console-only Kafka testing flows."}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-1-topic-describe-and-configs",children:"Step 1: Topic describe and configs"}),"\n",(0,t.jsx)(a.h3,{id:"create-or-verify-topic",children:"Create or verify topic"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-topics.sh --bootstrap-server kafka:9092   --create --topic onboarding-requested --partitions 1 --replication-factor 1\n"})}),"\n",(0,t.jsx)(a.h3,{id:"describe-topic",children:"Describe topic"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-topics.sh --bootstrap-server kafka:9092   --describe --topic onboarding-requested\n"})}),"\n",(0,t.jsx)(a.h3,{id:"change-retention-and-verify",children:"Change retention and verify"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-configs.sh --bootstrap-server kafka:9092   --alter --entity-type topics --entity-name onboarding-requested   --add-config retention.ms=60000\r\n\r\n/opt/bitnami/kafka/bin/kafka-topics.sh --bootstrap-server kafka:9092   --describe --topic onboarding-requested\n"})}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-2-increase-partitions-and-observe",children:"Step 2: Increase partitions and observe"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-topics.sh --bootstrap-server kafka:9092   --alter --topic onboarding-requested --partitions 3\r\n\r\n/opt/bitnami/kafka/bin/kafka-topics.sh --bootstrap-server kafka:9092   --describe --topic onboarding-requested\n"})}),"\n",(0,t.jsxs)(a.p,{children:["Produce same keys again and check partition assignment with ",(0,t.jsx)(a.code,{children:"print.partition=true"}),"."]}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-3-consumer-lag-monitoring",children:"Step 3: Consumer lag monitoring"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-consumer-groups.sh   --bootstrap-server kafka:9092   --describe --group group-kyc\n"})}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-4-offset-reset-demos",children:"Step 4: Offset reset demos"}),"\n",(0,t.jsx)(a.h3,{id:"earliest",children:"Earliest"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-consumer-groups.sh --bootstrap-server kafka:9092   --group group-kyc --topic onboarding-requested   --reset-offsets --to-earliest --execute\n"})}),"\n",(0,t.jsx)(a.h3,{id:"latest",children:"Latest"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-consumer-groups.sh --bootstrap-server kafka:9092   --group group-kyc --topic onboarding-requested   --reset-offsets --to-latest --execute\n"})}),"\n",(0,t.jsx)(a.h3,{id:"by-duration-last-24-hours",children:"By duration (last 24 hours)"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-consumer-groups.sh --bootstrap-server kafka:9092   --group group-kyc --topic onboarding-requested   --reset-offsets --by-duration PT24H --execute\n"})}),"\n",(0,t.jsx)(a.h3,{id:"specific-offset",children:"Specific offset"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-consumer-groups.sh --bootstrap-server kafka:9092   --group group-kyc --topic onboarding-requested:0   --reset-offsets --to-offset 10 --execute\n"})}),"\n",(0,t.jsxs)(a.p,{children:["Use ",(0,t.jsx)(a.code,{children:"--dry-run"})," before ",(0,t.jsx)(a.code,{children:"--execute"})," to preview."]}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-5-per-key-ordering-guarantee",children:"Step 5: Per-key ordering guarantee"}),"\n",(0,t.jsx)(a.p,{children:"Produce multiple events with same key and verify all land in the same partition in order."}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-6-sticky-partitioning-without-key",children:"Step 6: Sticky partitioning without key"}),"\n",(0,t.jsx)(a.p,{children:"Run producer without key and send multiple messages quickly:"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-console-producer.sh   --bootstrap-server kafka:9092 --topic onboarding-requested\n"})}),"\n",(0,t.jsx)(a.p,{children:"Observe how batches stick to partitions temporarily."}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-7-headers-via-rest-proxy-if-available",children:"Step 7: Headers via REST Proxy (if available)"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:'curl -X POST -H "Content-Type: application/vnd.kafka.json.v2+json"   --data \'{"records":[{"value":{"e":"x"},"headers":[{"key":"traceId","value":"dHJhY2Ux"}]}]}\'   http://localhost:8082/topics/onboarding-requested\n'})}),"\n",(0,t.jsx)(a.p,{children:"Headers are base64-encoded."}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-8-multiple-topics-fan-out",children:"Step 8: Multiple topics fan-out"}),"\n",(0,t.jsx)(a.p,{children:"Create additional topics and consumers in different groups. Observe one producer event being consumed by multiple services."}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-9-auto-create-off-validation",children:"Step 9: Auto-create off validation"}),"\n",(0,t.jsxs)(a.p,{children:["With ",(0,t.jsx)(a.code,{children:"KAFKA_CFG_AUTO_CREATE_TOPICS_ENABLE=false"}),", try producing to a nonexistent topic and check that it fails."]}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-10-cleanup-patterns",children:"Step 10: Cleanup patterns"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["With named volume: ",(0,t.jsx)(a.code,{children:"docker compose down -v"})," wipes all data."]}),"\n",(0,t.jsxs)(a.li,{children:["With bind mount: manually delete ",(0,t.jsx)(a.code,{children:"./data"})," folder for a clean start."]}),"\n"]}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-11-delete-topic-and-verify",children:"Step 11: Delete topic and verify"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-topics.sh --bootstrap-server kafka:9092   --delete --topic onboarding-requested\r\n\r\n/opt/bitnami/kafka/bin/kafka-topics.sh --bootstrap-server kafka:9092 --list\n"})}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-12-producer-acknowledgements-concept",children:"Step 12: Producer acknowledgements (concept)"}),"\n",(0,t.jsxs)(a.p,{children:["Console producer uses default ",(0,t.jsx)(a.code,{children:"acks=1"}),".",(0,t.jsx)(a.br,{}),"\n","For advanced durability (",(0,t.jsx)(a.code,{children:"acks=all"}),", ",(0,t.jsx)(a.code,{children:"enable.idempotence=true"}),"), test with code-based producers."]}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"step-13-rebalance-demo",children:"Step 13: Rebalance demo"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"Start 2 consumers in same group."}),"\n",(0,t.jsx)(a.li,{children:"Add a third consumer."}),"\n",(0,t.jsx)(a.li,{children:"Observe temporary pause and new partition assignments:"}),"\n"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"/opt/bitnami/kafka/bin/kafka-consumer-groups.sh   --bootstrap-server kafka:9092   --describe --group group-kyc\n"})}),"\n",(0,t.jsx)(a.hr,{}),"\n",(0,t.jsx)(a.h2,{id:"recap",children:"Recap"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["Use ",(0,t.jsx)(a.code,{children:"describe"})," and ",(0,t.jsx)(a.code,{children:"configs"})," to validate topics."]}),"\n",(0,t.jsx)(a.li,{children:"Test partition increase and key routing."}),"\n",(0,t.jsx)(a.li,{children:"Monitor consumer lag."}),"\n",(0,t.jsx)(a.li,{children:"Reset offsets to earliest, latest, by duration or specific offset."}),"\n",(0,t.jsx)(a.li,{children:"Observe per-key ordering and sticky partitioning."}),"\n",(0,t.jsx)(a.li,{children:"Try fan-out with multiple groups."}),"\n",(0,t.jsx)(a.li,{children:"Validate auto-create setting, retention, and delete topics."}),"\n",(0,t.jsx)(a.li,{children:"Watch rebalance when consumers join or leave."}),"\n"]})]})}function p(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);