"use strict";(self.webpackChunkmegatron_dev_docs=self.webpackChunkmegatron_dev_docs||[]).push([[9785],{3456:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>i});const o=JSON.parse('{"id":"projects/auth-system/02-keycloak-setup-docker-compose","title":"Keycloak Setup with Docker Compose","description":"In this step, we will set up a Keycloak server locally using Docker Compose, which will act as our Identity Provider (IdP) for authentication.","source":"@site/docs/projects/auth-system/02-keycloak-setup-docker-compose.md","sourceDirName":"projects/auth-system","slug":"/projects/auth-system/02-keycloak-setup-docker-compose","permalink":"/docs/projects/auth-system/02-keycloak-setup-docker-compose","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"02-keycloak-setup-docker-compose","title":"Keycloak Setup with Docker Compose","sidebar_position":2},"sidebar":"docs","previous":{"title":"Auth System Overview","permalink":"/docs/projects/auth-system/01-overview"},"next":{"title":"React + Keycloak Integration","permalink":"/docs/projects/auth-system/03-react-keycloak-integration"}}');var t=n(4848),s=n(8453);const a={id:"02-keycloak-setup-docker-compose",title:"Keycloak Setup with Docker Compose",sidebar_position:2},c="Keycloak Setup using Docker Compose",l={},i=[{value:"1. Project Directory Structure",id:"1-project-directory-structure",level:2},{value:"2. <code>docker-compose.yml</code>",id:"2-docker-composeyml",level:2},{value:"3. <code>Keycloak custom theme</code>",id:"3-keycloak-custom-theme",level:2},{value:"4. <code>Start keycloak</code>",id:"4-start-keycloak",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"keycloak-setup-using-docker-compose",children:"Keycloak Setup using Docker Compose"})}),"\n",(0,t.jsxs)(r.p,{children:["In this step, we will set up a ",(0,t.jsx)(r.strong,{children:"Keycloak server"})," locally using Docker Compose, which will act as our Identity Provider (IdP) for authentication."]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"1-project-directory-structure",children:"1. Project Directory Structure"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"auth-system/\r\n\u2502\r\n\u251c\u2500\u2500 keycloak/\r\n\u2502 \u251c\u2500\u2500 docker-compose.yml\r\n\u2502 \u2514\u2500\u2500 keycloak-themes/megatron-login \u2190 Custom themes go here (optional)\r\n|                     |__ theme.properties\r\n|                     |__ login\r\n|                     |    |__ common.ftl\r\n|                     |    |__ login.ftl\r\n|                     |    |__ register.ftl\r\n|                     |__ resources/css\r\n|                     |             |__style.css\r\n\n"})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsxs)(r.h2,{id:"2-docker-composeyml",children:["2. ",(0,t.jsx)(r.code,{children:"docker-compose.yml"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:'services:\r\n  keycloak:\r\n    image: quay.io/keycloak/keycloak:latest\r\n    container_name: keycloak\r\n    ports:\r\n      - "8080:8080"\r\n    environment:\r\n      KEYCLOAK_ADMIN: admin\r\n      KEYCLOAK_ADMIN_PASSWORD: admin\r\n      KC_DB: postgres\r\n      KC_DB_URL_HOST: keycloak-db\r\n      KC_DB_URL_PORT: 5432\r\n      KC_DB_USERNAME: keycloak\r\n      KC_DB_PASSWORD: keycloak\r\n    depends_on:\r\n      - keycloak-db\r\n    volumes:\r\n      - ./keycloak-themes:/opt/keycloak/themes\r\n    command:\r\n      [\r\n        "start-dev",\r\n        "--spi-theme-login-default=megatron-login",\r\n        "--spi-theme-welcome-default=base",\r\n      ]\r\n\r\n  keycloak-db:\r\n    image: postgres:15\r\n    container_name: keycloak-db\r\n    ports:\r\n      - "5432:5432"\r\n    environment:\r\n      POSTGRES_DB: keycloak\r\n      POSTGRES_USER: keycloak\r\n      POSTGRES_PASSWORD: keycloak\r\n    volumes:\r\n      - postgres_data:/var/lib/postgresql/data\r\n\r\nvolumes:\r\n  postgres_data:\n'})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsxs)(r.h2,{id:"3-keycloak-custom-theme",children:["3. ",(0,t.jsx)(r.code,{children:"Keycloak custom theme"})]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"theme.properties"}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-properties",children:"parent=base\r\nimport=common/keycloak\n"})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"login.ftl"}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ftl",children:'<#import "template.ftl" as layout>\r\n<@layout.registrationLayout displayInfo=true; section>\r\n  <div class="megatron-login-box">\r\n    <h1>Login to Megatron Store</h1>\r\n    <form id="kc-form-login" action="${url.loginAction}" method="post">\r\n      <input type="text" name="username" placeholder="Username or Email" class="input-field"/><br/>\r\n      <input type="password" name="password" placeholder="Password" class="input-field"/><br/>\r\n      <input type="submit" value="Login" class="btn-login"/>\r\n    </form>\r\n    <a href="${url.registrationUrl}">Register</a>\r\n  </div>\r\n</@layout.registrationLayout>\n'})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"register.ftl"}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ftl",children:'<#import "template.ftl" as layout>\r\n<@layout.registrationLayout displayInfo=true; section>\r\n  <div class="megatron-login-box">\r\n    <h1>Register at Megatron Store</h1>\r\n    <form id="kc-register-form" action="${url.registrationAction}" method="post">\r\n      <input type="text" id="username" name="username" placeholder="Username" class="input-field"/><br/>\r\n      <input type="text" id="email" name="email" placeholder="Email" class="input-field"/><br/>\r\n      <input type="password" id="password" name="password" placeholder="Password" class="input-field"/><br/>\r\n      <input type="password" id="password-confirm" name="password-confirm" placeholder="Confirm Password" class="input-field"/><br/>\r\n      <input type="submit" value="Register" class="btn-login"/>\r\n    </form>\r\n    <a href="${url.loginUrl}">Back to Login</a>\r\n  </div>\r\n</@layout.registrationLayout>\n'})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"style.css"}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-css",children:'body {\r\n  background-color: #f4f6f9;\r\n  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;\r\n}\r\n\r\n.megatron-login-box {\r\n  max-width: 400px;\r\n  margin: 60px auto;\r\n  background: white;\r\n  padding: 30px;\r\n  border-radius: 8px;\r\n  box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.1);\r\n  text-align: center;\r\n}\r\n\r\n.input-field {\r\n  width: 90%;\r\n  padding: 10px;\r\n  margin-bottom: 15px;\r\n  border-radius: 4px;\r\n  border: 1px solid #ccc;\r\n}\r\n\r\n.btn-login {\r\n  width: 95%;\r\n  background-color: #0066cc;\r\n  color: white;\r\n  padding: 12px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.btn-login:hover {\r\n  background-color: #004b99;\r\n}\n'})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsxs)(r.h2,{id:"4-start-keycloak",children:["4. ",(0,t.jsx)(r.code,{children:"Start keycloak"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-cmd",children:"cd keycloak\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-docker",children:" docker-compose up -d\n"})})]})}function p(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>c});var o=n(6540);const t={},s=o.createContext(t);function a(e){const r=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(s.Provider,{value:r},e.children)}}}]);